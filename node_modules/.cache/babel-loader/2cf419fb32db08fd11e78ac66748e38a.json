{"ast":null,"code":"import _WeakMap from \"@babel/runtime-corejs2/core-js/weak-map\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _Object$is from \"@babel/runtime-corejs2/core-js/object/is\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { isMobile } from './utils';\n/** Creates a rafLoop to handle scroll animations */\n\nexport var RafLoop =\n/*#__PURE__*/\nfunction () {\n  /**\n   * Create the RafLoop\n   * @param  {} el - Element to check the Yoffset\n   */\n  function RafLoop(_ref) {\n    var _this = this;\n\n    var mainScroll = _ref.mainScroll,\n        _ref$normalScroll = _ref.normalScroll,\n        normalScroll = _ref$normalScroll === void 0 ? false : _ref$normalScroll,\n        _ref$config = _ref.config,\n        config = _ref$config === void 0 ? {} : _ref$config;\n\n    _classCallCheck(this, RafLoop);\n\n    _defineProperty(this, \"setup\", function (_ref2) {\n      var _ref2$el = _ref2.el,\n          el = _ref2$el === void 0 ? window : _ref2$el;\n      _this.el = el;\n    });\n\n    _defineProperty(this, \"destroy\", function () {\n      _this.clear();\n    });\n\n    _defineProperty(this, \"onTouchStart\", function (_ref3) {\n      var _ref3$touches = _ref3.touches,\n          touches = _ref3$touches === void 0 ? [] : _ref3$touches;\n      if (!isMobile() || _this.normalScroll) return;\n\n      var _touches = _slicedToArray(touches, 1),\n          firstTouch = _touches[0];\n\n      if (!firstTouch) return;\n      var x = firstTouch.pageX,\n          y = firstTouch.pageY;\n      _this.touch = {\n        x: x,\n        y: y\n      };\n    });\n\n    _defineProperty(this, \"onTouchMove\", function (_ref4) {\n      var _ref4$touches = _ref4.touches,\n          touches = _ref4$touches === void 0 ? [] : _ref4$touches;\n      if (!isMobile() || _this.normalScroll) return;\n\n      var _touches2 = _slicedToArray(touches, 1),\n          firstTouch = _touches2[0];\n\n      if (!firstTouch) return;\n      var x = firstTouch.pageX,\n          y = firstTouch.pageY;\n      var deltaY = _this.touch.y - y;\n      _this.touch = {\n        x: x,\n        y: y\n      };\n\n      _this.updateScrollY(_this.scrollY + deltaY);\n    });\n\n    _defineProperty(this, \"onWheel\", function (_ref5) {\n      var deltaY = _ref5.deltaY,\n          deltaMode = _ref5.deltaMode;\n      if (_this.goingToPaused || _this.isPaused) return;\n      var factor = deltaMode === 1 ? 16 : .5;\n      _this.deltaY = deltaY;\n\n      _this.updateScrollY(_this.scrollY + deltaY * factor);\n    });\n\n    _defineProperty(this, \"updateScrollY\", function (scrollY) {\n      if (typeof scrollY !== \"number\" || isNaN(scrollY)) return;\n      _this.scrollY = scrollY;\n    });\n\n    _defineProperty(this, \"removeImportant\", function (fn) {\n      var func = _this.importantFunctionMap.get(fn);\n\n      _this.importantFunctionsToRun = _this.importantFunctionsToRun.filter(function (fn) {\n        return !_Object$is(fn, func);\n      });\n\n      _this.importantFunctionMap.delete(fn);\n    });\n\n    _defineProperty(this, \"addImportant\", function (fn) {\n      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        params[_key - 1] = arguments[_key];\n      }\n\n      var func = function func(e) {\n        return fn.apply(void 0, [e].concat(params));\n      };\n\n      _this.importantFunctionMap.set(fn, func);\n\n      _this.importantFunctionsToRun.push(func);\n\n      if (_this.importantFunctionsToRun.length >= 5) console.err(importantError);else if (_this.importantFunctionsToRun.length >= 3) console.warn(importantError);\n      if (!_this.isRunning) _this.start();\n    });\n\n    _defineProperty(this, \"addOnceImportant\", function (fn) {\n      for (var _len2 = arguments.length, params = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        params[_key2 - 1] = arguments[_key2];\n      }\n\n      var func = function func(e) {\n        fn.apply(void 0, [e].concat(params));\n\n        _this.remove(fn);\n      };\n\n      _this.importantFunctionMap.set(fn, func);\n\n      _this.importantFunctionsToRun.push(func);\n\n      if (!_this.isRunning) _this.start();\n    });\n\n    _defineProperty(this, \"remove\", function (fn) {\n      var func = _this.functionMap.get(fn);\n\n      _this.functionsToRun = _this.functionsToRun.filter(function (fn) {\n        return !_Object$is(fn, func);\n      });\n\n      _this.functionMap.delete(fn);\n    });\n\n    _defineProperty(this, \"add\", function (fn) {\n      for (var _len3 = arguments.length, params = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        params[_key3 - 1] = arguments[_key3];\n      }\n\n      var func = function func(e) {\n        return fn.apply(void 0, [e].concat(params));\n      };\n\n      _this.functionMap.set(fn, func);\n\n      _this.functionsToRun.push(func);\n\n      if (!_this.isRunning) _this.start();\n    });\n\n    _defineProperty(this, \"addOnce\", function (fn) {\n      for (var _len4 = arguments.length, params = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        params[_key4 - 1] = arguments[_key4];\n      }\n\n      var func = function func(e) {\n        fn.apply(void 0, [e].concat(params));\n\n        _this.remove(fn);\n      };\n\n      _this.functionMap.set(fn, func);\n\n      _this.functionsToRun.push(func);\n\n      if (!_this.isRunning) _this.start();\n    });\n\n    _defineProperty(this, \"start\", function () {\n      _this.isRunning = true;\n      window.requestAnimationFrame(_this.update);\n    });\n\n    _defineProperty(this, \"pause\", function () {\n      _this.goingToPaused = true;\n    });\n\n    _defineProperty(this, \"resume\", function () {\n      _this.goingToPaused = false;\n      if (!_this.isPaused) return;\n      _this.isPaused = false;\n    });\n\n    _defineProperty(this, \"clear\", function () {\n      _this.lastScroll = 0;\n      _this.deltaY = 0;\n      _this.functionsToRun = [];\n    });\n\n    _defineProperty(this, \"round\", function (num) {\n      return num < 0.0001 ? 0 : num;\n    });\n\n    _defineProperty(this, \"update\", function () {\n      _this.ticking = true;\n\n      if (!_this.isPaused || _this.importantFunctionsToRun.length > 0) {\n        var args = _this.getEvent();\n\n        for (var i = 0; i < _this.importantFunctionsToRun.length; i++) {\n          _this.importantFunctionsToRun[i](args);\n        }\n\n        for (var _i = 0; _i < _this.functionsToRun.length; _i++) {\n          _this.functionsToRun[_i](args);\n        }\n      }\n\n      _this.ticking = false;\n      if (_this.functionsToRun.length === 0 && _this.importantFunctionsToRun === 0) _this.isRunning = false;\n      if (_this.isRunning) window.requestAnimationFrame(_this.update);\n    });\n\n    this.mainScroll = mainScroll;\n    this.normalScroll = normalScroll;\n    this.config = _objectSpread({\n      timeToggle: 40,\n      timeCap: 300,\n      lerp: {\n        mouse: 0.1,\n        touchpad: 0.18\n      }\n    }, config);\n    this.touch = {\n      x: 0,\n      y: 0\n    };\n    this.onWheelTicks = new Array();\n    this.historyLength = 0;\n    this.inputType = \"touchpad\";\n    this.lerpedScroll = 0;\n    this.scrollY = 0;\n    this.functionMap = new _WeakMap();\n    this.functionsToRun = [];\n    this.importantFunctionMap = new _WeakMap();\n    this.importantFunctionsToRun = [];\n    this.goingToPaused = false;\n    this.isPaused = false;\n    this.ticking = false;\n    this.isRunning = false;\n    this.isScrollAnimating = false;\n  }\n\n  _createClass(RafLoop, [{\n    key: \"getLerpedScroll\",\n    value: function getLerpedScroll() {\n      if (isMobile() || this.normalScroll || this.isScrollAnimating) return this.scrollY;\n      this.lerpedScroll += (this.scrollY - this.lerpedScroll) * .08;\n      return this.lerpedScroll;\n    }\n    /**\n     * Get the current arguments for the loop\n     * @returns {object} args\n     */\n\n  }, {\n    key: \"getEvent\",\n    value: function getEvent() {\n      // TODO: fix deltaY for mobile\n      // if (this.ticking) this.deltaY = this.scrollY - this.lastScroll\n      var scrollY = this.getLerpedScroll();\n\n      if (this.goingToPaused && scrollY === this.scrollY) {\n        this.isPaused = true;\n      }\n\n      return {\n        scrollY: scrollY,\n        deltaY: this.deltaY\n      };\n    } // --- Loop ---\n\n    /**\n     * Default loop function\n     */\n\n  }]);\n\n  return RafLoop;\n}();","map":{"version":3,"sources":["/Users/dion/Sites/destudio/utils/rafLoop.js"],"names":["isMobile","RafLoop","mainScroll","normalScroll","config","el","window","clear","touches","firstTouch","x","pageX","y","pageY","touch","deltaY","updateScrollY","scrollY","deltaMode","goingToPaused","isPaused","factor","isNaN","fn","func","importantFunctionMap","get","importantFunctionsToRun","filter","delete","params","e","set","push","length","console","err","importantError","warn","isRunning","start","remove","functionMap","functionsToRun","requestAnimationFrame","update","lastScroll","num","ticking","args","getEvent","i","timeToggle","timeCap","lerp","mouse","touchpad","onWheelTicks","Array","historyLength","inputType","lerpedScroll","isScrollAnimating","getLerpedScroll"],"mappings":"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","sourcesContent":["import {isMobile,} from './utils'\n\n/** Creates a rafLoop to handle scroll animations */\nexport class RafLoop {\n    /**\n     * Create the RafLoop\n     * @param  {} el - Element to check the Yoffset\n     */\n    constructor({mainScroll, normalScroll = false, config = {},}) {\n        this.mainScroll = mainScroll\n        this.normalScroll = normalScroll\n\n        this.config = {\n            timeToggle: 40,\n            timeCap: 300,\n            lerp: {\n                mouse: 0.1,\n                touchpad: 0.18,\n            },\n            ...config,\n        }\n\n        this.touch = {x: 0, y: 0,}\n\n        this.onWheelTicks = new Array()\n        this.historyLength = 0\n\n        this.inputType = `touchpad`\n\n        this.lerpedScroll = 0\n        this.scrollY = 0\n\n        this.functionMap = new WeakMap()\n        this.functionsToRun = []\n\n        this.importantFunctionMap = new WeakMap()\n        this.importantFunctionsToRun = []\n\n        this.goingToPaused = false\n        this.isPaused = false\n\n        this.ticking = false\n        this.isRunning = false\n        this.isScrollAnimating = false\n    }\n\n    setup = ({el = window}) => {\n        this.el = el\n    }\n\n    /**\n     * Set the eventlisteners\n     * @param  {} el - Element to check the Yoffset\n     */\n    destroy = () => {\n        this.clear()\n    }\n\n    // --- Events ---\n    onTouchStart = ({touches = [],}) => {\n        if (!isMobile() || this.normalScroll) return\n\n        const [firstTouch,] = touches\n\n        if (!firstTouch) return\n        const {pageX: x, pageY: y,} = firstTouch\n\n        this.touch = {x, y,}\n    }\n\n    onTouchMove = ({touches = [],}) => {\n        if (!isMobile() || this.normalScroll) return\n\n        const [firstTouch,] = touches\n\n        if (!firstTouch) return\n        const {pageX: x, pageY: y,} = firstTouch\n\n        const deltaY = this.touch.y - y\n        this.touch = {x, y,}\n\n        this.updateScrollY(this.scrollY + deltaY)\n    }\n\n    onWheel = ({deltaY, deltaMode,}) => {\n        if (this.goingToPaused || this.isPaused) return\n        const factor = deltaMode === 1 ? 16 : .5\n\n        this.deltaY = deltaY\n        this.updateScrollY(this.scrollY + deltaY * factor)\n    }\n\n    // --- Helpers ---\n    updateScrollY = scrollY => {\n        if (typeof scrollY !== `number` || isNaN(scrollY)) return\n\n        this.scrollY = scrollY\n    }\n\n    // --- Public functions ---\n    /**\n     * Remove a function from the loop\n     * @param  {function} fn\n     */\n    removeImportant = fn => {\n        const func = this.importantFunctionMap.get(fn)\n        this.importantFunctionsToRun = this.importantFunctionsToRun.filter(\n            fn => !Object.is(fn, func)\n        )\n        this.importantFunctionMap.delete(fn)\n    }\n\n    /**\n     * Add a function to the loop\n     * @param  {function} fn - function to be added\n     * @param  {function} params - Parameters to be given when the functions runs\n     */\n    addImportant = (fn, ...params) => {\n        const func = e => fn(e, ...params)\n        this.importantFunctionMap.set(fn, func)\n        this.importantFunctionsToRun.push(func)\n\n        if (this.importantFunctionsToRun.length >= 5)\n            console.err(importantError)\n        else if (this.importantFunctionsToRun.length >= 3)\n            console.warn(importantError)\n\n        if (!this.isRunning) this.start()\n    }\n\n    /**\n     * Add a function to the loop to be run once\n     * @param  {function} fn - function to be added\n     * @param  {function} params - Parameters to be given when the functions runs\n     */\n    addOnceImportant = (fn, ...params) => {\n        const func = e => {\n            fn(e, ...params)\n            this.remove(fn)\n        }\n        this.importantFunctionMap.set(fn, func)\n        this.importantFunctionsToRun.push(func)\n\n        if (!this.isRunning) this.start()\n    }\n\n    /**\n     * Remove a function from the loop\n     * @param  {function} fn\n     */\n    remove = fn => {\n        const func = this.functionMap.get(fn)\n        this.functionsToRun = this.functionsToRun.filter(\n            fn => !Object.is(fn, func)\n        )\n        this.functionMap.delete(fn)\n    }\n\n    /**\n     * Add a function to the loop\n     * @param  {function} fn - function to be added\n     * @param  {function} params - Parameters to be given when the functions runs\n     */\n    add = (fn, ...params) => {\n        const func = e => fn(e, ...params)\n        this.functionMap.set(fn, func)\n        this.functionsToRun.push(func)\n\n        if (!this.isRunning) this.start()\n    }\n\n    /**\n     * Add a function to the loop to be run once\n     * @param  {function} fn - function to be added\n     * @param  {function} params - Parameters to be given when the functions runs\n     */\n    addOnce = (fn, ...params) => {\n        const func = e => {\n            fn(e, ...params)\n            this.remove(fn)\n        }\n        this.functionMap.set(fn, func)\n        this.functionsToRun.push(func)\n\n        if (!this.isRunning) this.start()\n    }\n\n    // --- Toggle the loop ---\n\n    /**\n     * Start the loop\n     */\n    start = () => {\n        this.isRunning = true\n        window.requestAnimationFrame(this.update)\n    }\n\n    /**\n     * Pause the loop\n     */\n    pause = () => {\n        this.goingToPaused = true\n    }\n\n    /**\n     * Resume the loop\n     */\n    resume = () => {\n        this.goingToPaused = false\n\n        if (!this.isPaused) return\n        this.isPaused = false\n    }\n\n    /**\n     * Clear the rafScroll\n     */\n    clear = () => {\n        this.lastScroll = 0\n        this.deltaY = 0\n        this.functionsToRun = []\n    }\n\n    round = num => (num < 0.0001 ? 0 : num)\n\n    getLerpedScroll() {\n        if (isMobile() || this.normalScroll || this.isScrollAnimating)\n            return this.scrollY\n\n        this.lerpedScroll += (this.scrollY - this.lerpedScroll) * .08\n\n        return this.lerpedScroll\n    }\n\n    /**\n     * Get the current arguments for the loop\n     * @returns {object} args\n     */\n    getEvent() {\n        // TODO: fix deltaY for mobile\n        // if (this.ticking) this.deltaY = this.scrollY - this.lastScroll\n        const scrollY = this.getLerpedScroll()\n\n        if (this.goingToPaused && scrollY === this.scrollY) {\n            this.isPaused = true\n        }\n\n        return {\n            scrollY,\n            deltaY: this.deltaY,\n        }\n    }\n\n    // --- Loop ---\n\n    /**\n     * Default loop function\n     */\n    update = () => {\n        this.ticking = true\n\n        if (!this.isPaused || this.importantFunctionsToRun.length > 0) {\n            const args = this.getEvent()\n\n            for (let i = 0; i < this.importantFunctionsToRun.length; i++) {\n                this.importantFunctionsToRun[i](args)\n            }\n\n            for (let i = 0; i < this.functionsToRun.length; i++) {\n                this.functionsToRun[i](args)\n            }\n        }\n        this.ticking = false\n\n        if (\n            this.functionsToRun.length === 0 &&\n            this.importantFunctionsToRun === 0\n        )\n            this.isRunning = false\n        if (this.isRunning) window.requestAnimationFrame(this.update)\n    }\n}\n"]},"metadata":{},"sourceType":"module"}